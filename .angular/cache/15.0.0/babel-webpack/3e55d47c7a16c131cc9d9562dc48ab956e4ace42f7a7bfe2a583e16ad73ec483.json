{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { LOCALE_ID } from '@angular/core';\nimport { CalendarComponent } from 'ionic2-calendar';\nimport { HttpClient } from '@angular/common/http';\nimport { formatDate } from '@angular/common';\nimport { EventModalPage } from '../event-modal/event-modal.page';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"@ionic/storage\";\nfunction SchedulePage_ng_template_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0);\n  }\n  if (rf & 2) {\n    const view_r4 = ctx.view;\n    const row_r5 = ctx.row;\n    const col_r6 = ctx.col;\n    i0.ɵɵtextInterpolate1(\" \", view_r4.dates[row_r5 * 7 + col_r6].label, \" \");\n  }\n}\nfunction SchedulePage_ng_template_31_ion_list_0_ion_item_1_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 26);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"date\");\n    i0.ɵɵpipe(3, \"date\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const event_r13 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", i0.ɵɵpipeBind2(2, 2, event_r13.startTime, \"h:mma\"), \"-\", i0.ɵɵpipeBind2(3, 5, event_r13.endTime, \"h:mma\"), \" \");\n  }\n}\nfunction SchedulePage_ng_template_31_ion_list_0_ion_item_1_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 26);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r15 = i0.ɵɵnextContext(4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r15.allDayLabel);\n  }\n}\nfunction SchedulePage_ng_template_31_ion_list_0_ion_item_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 23);\n    i0.ɵɵlistener(\"click\", function SchedulePage_ng_template_31_ion_list_0_ion_item_1_Template_ion_item_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r18);\n      const event_r13 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r17.onEventSelected(event_r13));\n    });\n    i0.ɵɵtemplate(1, SchedulePage_ng_template_31_ion_list_0_ion_item_1_span_1_Template, 4, 8, \"span\", 24);\n    i0.ɵɵtemplate(2, SchedulePage_ng_template_31_ion_list_0_ion_item_1_span_2_Template, 2, 1, \"span\", 24);\n    i0.ɵɵelementStart(3, \"span\", 25);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"slice\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const event_r13 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !event_r13.allDay);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", event_r13.allDay);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\\u00A0 | \", event_r13.title.length > 20 ? i0.ɵɵpipeBind3(5, 3, event_r13.title, 0, 20) + \"..\" : event_r13.title, \"\");\n  }\n}\nfunction SchedulePage_ng_template_31_ion_list_0_ion_item_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-item\", 27)(1, \"div\", 28);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const noEventsLabel_r9 = i0.ɵɵnextContext(2).noEventsLabel;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(noEventsLabel_r9);\n  }\n}\nfunction SchedulePage_ng_template_31_ion_list_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\", 20);\n    i0.ɵɵtemplate(1, SchedulePage_ng_template_31_ion_list_0_ion_item_1_Template, 6, 7, \"ion-item\", 21);\n    i0.ɵɵtemplate(2, SchedulePage_ng_template_31_ion_list_0_ion_item_2_Template, 3, 1, \"ion-item\", 22);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const selectedDate_r8 = i0.ɵɵnextContext().selectedDate;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", selectedDate_r8 == null ? null : selectedDate_r8.events);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (selectedDate_r8 == null ? null : selectedDate_r8.events.length) == 0);\n  }\n}\nfunction SchedulePage_ng_template_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, SchedulePage_ng_template_31_ion_list_0_Template, 3, 2, \"ion-list\", 19);\n  }\n  if (rf & 2) {\n    const showEventDetail_r7 = ctx.showEventDetail;\n    i0.ɵɵproperty(\"ngIf\", showEventDetail_r7);\n  }\n}\nexport let SchedulePage = /*#__PURE__*/(() => {\n  class SchedulePage {\n    constructor(router, http, alertCtrl, locale, modalCtrl, storage) {\n      this.router = router;\n      this.http = http;\n      this.alertCtrl = alertCtrl;\n      this.locale = locale;\n      this.modalCtrl = modalCtrl;\n      this.storage = storage;\n      this.eventSource = [];\n      this.calendar = {\n        mode: 'month',\n        currentDate: new Date()\n      };\n      this.loadAllEvents();\n    }\n    next() {\n      this.myCal.slideNext();\n    }\n    back() {\n      this.myCal.slidePrev();\n    }\n    onViewTitleChanged(title) {\n      this.viewTitle = title;\n    }\n    loadAllEvents() {\n      this.eventSource = this.loadEvents();\n    }\n    loadEvents() {\n      this.storage.get('userID').then(val => {\n        var obj = {\n          func: \"get_my_events\",\n          userID: val\n        };\n        this.http.post(\"https://recycle.hpc.tcnj.edu/php/events-handler.php\", JSON.stringify(obj)).subscribe(data => {\n          var result = data;\n          console.log(result);\n          this.createStaticNormalDayEvents(result);\n          this.myCal.loadEvents();\n        });\n      });\n      return this.eventSource;\n    }\n    createStaticNormalDayEvents(events) {\n      for (var i = 0; i < events.length; i++) {\n        var date = events[i][\"eventDate\"].split(\"-\");\n        date = new Date(parseInt(date[0]), parseInt(date[1]) - 1, parseInt(date[2]));\n        var name = events[i][\"eventName\"];\n        var description = events[i][\"eventDescription\"];\n        var start = events[i][\"startTime\"].split(\":\", 2);\n        var startHour = start[0];\n        var startMinute = start[1];\n        var end = events[i][\"endTime\"].split(\":\", 2);\n        var endHour = end[0];\n        var endMinute = end[1];\n        var startTime = new Date(date.getFullYear(), date.getMonth(), date.getDate(), startHour, startMinute, 0);\n        var endTime = new Date(date.getFullYear(), date.getMonth(), date.getDate(), endHour, endMinute, 0);\n        this.eventSource.push({\n          title: name,\n          startTime: startTime,\n          endTime: endTime,\n          desc: description,\n          allDay: false,\n          ID: events[i][\"eventID\"],\n          registered: events[i][\"attended\"] != null\n        });\n      }\n    }\n    passEventArray(ev) {\n      let navigationExtras = {\n        state: {\n          events: this.eventSource\n        }\n      };\n      this.router.navigate(['/my-registered-events'], navigationExtras);\n    }\n    // https://stackoverflow.com/questions/1500260/detect-urls-in-text-with-javascript \n    // function to detect a link from within an event description and allow it to be clickable in the event\n    linkify(text) {\n      var urlRegex = /(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|])/ig;\n      return text.replace(urlRegex, function (url) {\n        url = '<a href=\"' + url + '\" target=\"_blank\">  here </a>';\n        console.log(url);\n        return url;\n      });\n    }\n    onEventSelected(event) {\n      return __awaiter(this, void 0, void 0, function* () {\n        let date = formatDate(event.startTime, 'MMM d, yyyy', this.locale);\n        let start = formatDate(event.startTime, 'h:mma', this.locale);\n        let end = formatDate(event.endTime, 'h:mma', this.locale);\n        const modal = yield this.modalCtrl.create({\n          component: EventModalPage,\n          componentProps: {\n            eventObj: event,\n            eventName: event.title,\n            eventTime: date + '    ' + start + ' - ' + end,\n            eventDescription: this.linkify(event.desc),\n            eventID: event.ID,\n            registered: event.registered\n          }\n        });\n        yield modal.present();\n      });\n    }\n  }\n  SchedulePage.ɵfac = function SchedulePage_Factory(t) {\n    return new (t || SchedulePage)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i3.AlertController), i0.ɵɵdirectiveInject(LOCALE_ID), i0.ɵɵdirectiveInject(i3.ModalController), i0.ɵɵdirectiveInject(i4.Storage));\n  };\n  SchedulePage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SchedulePage,\n    selectors: [[\"app-schedule\"]],\n    viewQuery: function SchedulePage_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(CalendarComponent, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.myCal = _t.first);\n      }\n    },\n    decls: 37,\n    vars: 7,\n    consts: [[\"mode\", \"ios\"], [1, \"ion-text-wrap\"], [\"slot\", \"start\"], [\"menu\", \"main-menu\"], [3, \"ngModel\", \"ngModelChange\"], [\"value\", \"month\"], [\"value\", \"week\"], [\"value\", \"day\"], [\"size\", \"2\"], [\"aria-label\", \"back\", \"fill\", \"clear\", 3, \"click\"], [\"name\", \"arrow-back\", \"slot\", \"icon-only\"], [\"size\", \"8\", 1, \"ion-text-center\"], [\"aria-label\", \"next\", \"fill\", \"clear\", 3, \"click\"], [\"name\", \"arrow-forward\", \"slot\", \"icon-only\"], [3, \"eventSource\", \"calendarMode\", \"currentDate\", \"monthviewDisplayEventTemplate\", \"monthviewEventDetailTemplate\", \"onTitleChanged\", \"onEventSelected\"], [\"foo\", \"\"], [\"template\", \"\"], [1, \"ion-no-border\"], [\"aria-label\", \"My Registered Events\", \"color\", \"success\", \"expand\", \"block\", 1, \"small-text\", 3, \"click\"], [\"class\", \"event-detail-container\", \"has-bouncing\", \"false\", \"overflow-scroll\", \"false\", 4, \"ngIf\"], [\"has-bouncing\", \"false\", \"overflow-scroll\", \"false\", 1, \"event-detail-container\"], [\"lines\", \"full\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"lines\", \"full\", 4, \"ngIf\"], [\"lines\", \"full\", 3, \"click\"], [\"class\", \"monthview-eventdetail-timecolumn\", 4, \"ngIf\"], [1, \"event-detail\"], [1, \"monthview-eventdetail-timecolumn\"], [\"lines\", \"full\"], [1, \"no-events-label\"]],\n    template: function SchedulePage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\", 0)(2, \"ion-title\")(3, \"div\", 1);\n        i0.ɵɵtext(4, \" My Schedule \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"ion-buttons\", 2);\n        i0.ɵɵelement(6, \"ion-menu-button\", 3);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(7, \"ion-content\")(8, \"ion-segment\", 4);\n        i0.ɵɵlistener(\"ngModelChange\", function SchedulePage_Template_ion_segment_ngModelChange_8_listener($event) {\n          return ctx.calendar.mode = $event;\n        });\n        i0.ɵɵelementStart(9, \"ion-segment-button\", 5)(10, \"ion-label\");\n        i0.ɵɵtext(11, \"Month\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"ion-segment-button\", 6)(13, \"ion-label\");\n        i0.ɵɵtext(14, \"Week\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"ion-segment-button\", 7)(16, \"ion-label\");\n        i0.ɵɵtext(17, \"Day\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(18, \"ion-row\")(19, \"ion-col\", 8)(20, \"ion-button\", 9);\n        i0.ɵɵlistener(\"click\", function SchedulePage_Template_ion_button_click_20_listener() {\n          return ctx.back();\n        });\n        i0.ɵɵelement(21, \"ion-icon\", 10);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(22, \"ion-col\", 11)(23, \"h2\");\n        i0.ɵɵtext(24);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(25, \"ion-col\", 8)(26, \"ion-button\", 12);\n        i0.ɵɵlistener(\"click\", function SchedulePage_Template_ion_button_click_26_listener() {\n          return ctx.next();\n        });\n        i0.ɵɵelement(27, \"ion-icon\", 13);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(28, \"calendar\", 14);\n        i0.ɵɵlistener(\"onTitleChanged\", function SchedulePage_Template_calendar_onTitleChanged_28_listener($event) {\n          return ctx.onViewTitleChanged($event);\n        })(\"onEventSelected\", function SchedulePage_Template_calendar_onEventSelected_28_listener($event) {\n          return ctx.onEventSelected($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(29, SchedulePage_ng_template_29_Template, 1, 1, \"ng-template\", null, 15, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵtemplate(31, SchedulePage_ng_template_31_Template, 1, 1, \"ng-template\", null, 16, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"ion-footer\", 17)(34, \"ion-toolbar\")(35, \"ion-button\", 18);\n        i0.ɵɵlistener(\"click\", function SchedulePage_Template_ion_button_click_35_listener($event) {\n          return ctx.passEventArray($event);\n        });\n        i0.ɵɵtext(36, \"My Registered Events\");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(30);\n        const _r2 = i0.ɵɵreference(32);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngModel\", ctx.calendar.mode);\n        i0.ɵɵadvance(16);\n        i0.ɵɵtextInterpolate(ctx.viewTitle);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"eventSource\", ctx.eventSource)(\"calendarMode\", ctx.calendar.mode)(\"currentDate\", ctx.calendar.currentDate)(\"monthviewDisplayEventTemplate\", _r0)(\"monthviewEventDetailTemplate\", _r2);\n      }\n    },\n    styles: [\".event-indicator[_ngcontent-%COMP%]{background:var(--ion-color-success);width:5px;height:5px;border-radius:5px;margin:0;padding:0;display:table-cell;word-wrap:break-word;display:none}.indicator-container[_ngcontent-%COMP%]{padding-left:.5rem;padding-bottom:.4rem;word-wrap:break-word}[_nghost-%COMP%]     .monthview-primary-with-event{background-color:var(--ion-color-primary)!important}[_nghost-%COMP%]     .monthview-selected{background-color:var(--ion-color-success)!important}.with-event[_ngcontent-%COMP%]{background-color:var(--ion-color-primary)}\"]\n  });\n  return SchedulePage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}